# Дорасчет ежемесячных текущих показаний по счётчикам

## Алгоритмы дорасчета текущих показаний:

Для расчёта используется три файла, которые лежат в папке data:

A = "архив.xlsx"
B = "интегральные_показания.xlsx"
C  = "показания_за_период.xlsx"


Файл A нужен только для того, чтобы к данным из файла B по полю "Код ЭО" добавить "АСКУЭ", "Шифр опоры".

Расчёт текущих показаний производитс в следующем приоритете, если в файле C заполнены "действительно на1" и "действительно на2" и данные валидны:

1. Алгоритм base_algoritm - если сходится "Номер ПУ" и "Шифр опоры" из B с С тогда алгоритм следующий, а также заполнены "Показания на конец периода" в C:
   1.1. Если в столбце "действительно на1" указано первое число прошедшего месяца, а в "действительно на2" указано первое число нового месяца, тогда текущие показания расчитываем так:
   x = y
   где y - показания на конец периода из C
   2.2. Если в столбце "действительно на1" указано НЕ первое число прошедшего месяца или в "действительно на2" указано НЕ первое число нового месяца, тогда текущие показания:
   x = r * dt / n + y
   где r - расход из C, n - кол-во дней между промежутками (кол-во опрошенных дней), dt - количество дней в месяце минус n.

2. Алгоритм add_algoritm - если тип точки учета "Комерческая" (приоритет) или "Контрольная" тогда текущие показания расчитываем следующим образом:
   2.1. Если в столбце "действительно на1" указано первое число прошедшего месяца, а в "действительно на2" указано первое число нового месяца, тогда текущие показания расчитываем так:
   x = r + z
   где z - "Предыдущие показания" из B
   2.2. Если в столбце "действительно на1" указано НЕ первое число прошедшего месяца или в "действительно на2" указано НЕ первое число нового месяца, тогда текущие показания:
   x = r * dt / n + z

3. Алгоритм extra_algoritm:
  3.1. Если у опоры нет источника питания и она нигде не указана в качестве источника питания:
   x = a * F + z
   где a - количество "Групп операторов" ("Megafon", "MTS", "Tele2", "Vimpelcom")
   

# calculating_of_meter_readings
Ежемесячный дорасчет показаний счетчиков TowerStore


```bash
pyinstaller --onefile --icon=icon.ico --add-data "data;data" --add-data "logs;logs" main.py
```
| Создание исполняемого файла из python скрипта
