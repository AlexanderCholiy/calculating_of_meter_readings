<h1 align="center">CALCULATING_OF_METER_READINGS</h1>

**CALCULATING_OF_METER_READINGS** ‚Äî –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –¥–æ—Ä–∞—Å—á—ë—Ç —Ç–µ–∫—É—â–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å—á—ë—Ç—á–∏–∫–æ–≤ TowerStore –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ —Ç–µ–∫—É—â–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –ø–æ —Å—á—ë—Ç—á–∏–∫–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—Ä—Ö–∏–≤–Ω—ã—Ö, –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã—Ö –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å —É—á—ë—Ç–æ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

---

## üöÄ –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ–µ–∫—Ç–æ–º

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É `dist`.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª main.exe.
3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á—ë—Ç–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ `data` –≤ —Ñ–∞–π–ª–µ `calculation_results.xlsx`:
   - **calc** ‚Äî –∏—Ç–æ–≥–æ–≤—ã–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è;
   - **add** ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–∞—Ö.
4. –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç—á—ë—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ `logs`.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `.env`.

–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ                  | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|---------------------------|-----------------------|
|  `AVG_EXP` | –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –ø–æ –æ–ø–æ—Ä–µ   | `1200`                |
|  `DEBUG`   | –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å | `False`               |

# –î–æ—Ä–∞—Å—á–µ—Ç –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö —Ç–µ–∫—É—â–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –ø–æ —Å—á—ë—Ç—á–∏–∫–∞–º

## –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ–µ–∫—Ç–æ–º

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É dist –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ main.exe
2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ data –≤ —Ñ–∞–π–ª–µ calculation_results.xlsx –Ω–∞ –ª–∏—Å—Ç–µ calc. –ù–∞ –ª–∏—Å—Ç–µ add –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∫–æ—Å–∞—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—á–µ—Ç–æ–≤.
3. –ï—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞—Å—á–µ—Ç–∞ –±—É–¥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –æ—à–∏–±–∫–∏, –æ—Ç—á–µ—Ç—ã –ø–æ –Ω–∏–º –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ logs.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:

–í —Ñ–∞–π–ª–µ .env –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å AVG_EXP - —Å—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –ø–æ –æ–ø–æ—Ä–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1200). –î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º—ã –º–µ–∂–¥—É DEBUG = True –∏–ª–∏ False

## –ê–ª–≥–æ—Ä–∏—Ç–º—ã –¥–æ—Ä–∞—Å—á–µ—Ç–∞ —Ç–µ–∫—É—â–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π:

–î–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç—Ä–∏ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–∂–∞—Ç –≤ –ø–∞–ø–∫–µ data:

A = "–∞—Ä—Ö–∏–≤.xlsx"
B = "–∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã–µ_–ø–æ–∫–∞–∑–∞–Ω–∏—è.xlsx"
C  = "–ø–æ–∫–∞–∑–∞–Ω–∏—è_–∑–∞_–ø–µ—Ä–∏–æ–¥.xlsx"


–§–∞–π–ª A –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫ –¥–∞–Ω–Ω—ã–º –∏–∑ —Ñ–∞–π–ª–∞ B –ø–æ –ø–æ–ª—é "–ö–æ–¥ –≠–û" –¥–æ–±–∞–≤–∏—Ç—å "–ê–°–ö–£–≠", "–®–∏—Ñ—Ä –æ–ø–æ—Ä—ã".

–†–∞—Å—á—ë—Ç —Ç–µ–∫—É—â–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ, –µ—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ C –∑–∞–ø–æ–ª–Ω–µ–Ω—ã "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞1" –∏ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞2" –∏ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–Ω—ã:

1. –ê–ª–≥–æ—Ä–∏—Ç–º base_algoritm - –µ—Å–ª–∏ —Å—Ö–æ–¥–∏—Ç—Å—è "–ù–æ–º–µ—Ä –ü–£" –∏ "–®–∏—Ñ—Ä –æ–ø–æ—Ä—ã" –∏–∑ B —Å –° —Ç–æ–≥–¥–∞ –∞–ª–≥–æ—Ä–∏—Ç–º —Å–ª–µ–¥—É—é—â–∏–π, –∞ —Ç–∞–∫–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã "–ü–æ–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞" –≤ C:
   1.1. –ï—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞1" —É–∫–∞–∑–∞–Ω–æ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –º–µ—Å—è—Ü–∞, –∞ –≤ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞2" —É–∫–∞–∑–∞–Ω–æ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –Ω–æ–≤–æ–≥–æ –º–µ—Å—è—Ü–∞, —Ç–æ–≥–¥–∞ —Ç–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–∞–∫:
   x = y
   –≥–¥–µ y - –ø–æ–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –∏–∑ C
   2.2. –ï—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞1" —É–∫–∞–∑–∞–Ω–æ –ù–ï –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –º–µ—Å—è—Ü–∞ –∏–ª–∏ –≤ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞2" —É–∫–∞–∑–∞–Ω–æ –ù–ï –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –Ω–æ–≤–æ–≥–æ –º–µ—Å—è—Ü–∞, —Ç–æ–≥–¥–∞ —Ç–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è:
   x = r * dt / n + y
   –≥–¥–µ r - —Ä–∞—Å—Ö–æ–¥ –∏–∑ C, n - –∫–æ–ª-–≤–æ –¥–Ω–µ–π –º–µ–∂–¥—É –ø—Ä–æ–º–µ–∂—É—Ç–∫–∞–º–∏ (–∫–æ–ª-–≤–æ –æ–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö –¥–Ω–µ–π), dt - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –≤ –º–µ—Å—è—Ü–µ –º–∏–Ω—É—Å n.

2. –ê–ª–≥–æ—Ä–∏—Ç–º add_algoritm - –µ—Å–ª–∏ —Ç–∏–ø —Ç–æ—á–∫–∏ —É—á–µ—Ç–∞ "–ö–æ–º–µ—Ä—á–µ—Å–∫–∞—è" (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) –∏–ª–∏ "–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è" —Ç–æ–≥–¥–∞ —Ç–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
   2.1. –ï—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞1" —É–∫–∞–∑–∞–Ω–æ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –º–µ—Å—è—Ü–∞, –∞ –≤ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞2" —É–∫–∞–∑–∞–Ω–æ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –Ω–æ–≤–æ–≥–æ –º–µ—Å—è—Ü–∞, —Ç–æ–≥–¥–∞ —Ç–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–∞–∫:
   x = r + z
   –≥–¥–µ z - "–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è" –∏–∑ B
   2.2. –ï—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞1" —É–∫–∞–∑–∞–Ω–æ –ù–ï –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –º–µ—Å—è—Ü–∞ –∏–ª–∏ –≤ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∞2" —É–∫–∞–∑–∞–Ω–æ –ù–ï –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –Ω–æ–≤–æ–≥–æ –º–µ—Å—è—Ü–∞, —Ç–æ–≥–¥–∞ —Ç–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è:
   x = r * dt / n + z

3. –ê–ª–≥–æ—Ä–∏—Ç–º extra_algoritm:
   3.1. –ï—Å–ª–∏ —É –æ–ø–æ—Ä—ã –Ω–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è –∏ –æ–Ω–∞ –Ω–∏–≥–¥–µ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è:
   x = a * AVG_EXP + z
   –≥–¥–µ a - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ "–ì—Ä—É–ø–ø –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤" ("Megafon", "MTS", "Tele2", "Vimpelcom")

   3.2. –ï—Å–ª–∏ –Ω–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è, –Ω–æ –æ–Ω–∞ –¥–ª—è –∫–∞–∫–∏—Ö —Ç–æ –¥—Ä—É–≥–∏—Ö –æ–ø–æ—Ä —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø–∏—Ç–∞–Ω–∏—è (–º–∞—Å—Ç–µ—Ä –æ–ø–æ—Ä–∞), —Ç–æ–≥–¥–∞:
   b = —Å—É–º–º–∞ –∞ –ø–æ –∫–∞–∂–¥–æ–π –∏–∑ —ç—Ç–æ–π –≥—Ä—É–ø–ø—ã –æ–ø–æ—Ä –≥–¥–µ —É–∫–∞–∑–∞–Ω–Ω–∞—è –æ–ø–æ—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Ç–µ—Ä –æ–ø–æ—Ä–æ–π + —Å–∞–º–∞ –æ–ø–æ—Ä–∞
   x = b * AVG_EXP + z

   3.3. –ï—Å–ª–∏ —É –æ–ø–æ—Ä—ã –µ—Å—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è, —Ç–æ–≥–¥–∞
   x = z

# calculating_of_meter_readings
–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –¥–æ—Ä–∞—Å—á–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å—á–µ—Ç—á–∏–∫–æ–≤ TowerStore


## –ü–æ–¥–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
pyinstaller --onefile --icon=icon.ico --add-data "data;data" --add-data "logs;logs" main.py
```
| –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑ python —Å–∫—Ä–∏–ø—Ç–∞
